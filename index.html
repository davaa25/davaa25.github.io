<script>
const topicInput = document.getElementById('topicInput');
const generateBtn = document.getElementById('generateBtn');
const resultsSection = document.getElementById('resultsSection');
const titlesContainer = document.getElementById('titlesContainer');

topicInput.addEventListener('input', () => {
  generateBtn.disabled = topicInput.value.trim() === '';
});

async function generateTitles(topic) {
  titlesContainer.innerHTML = '';
  resultsSection.style.display = 'block';

  try {
    const res = await fetch('/api/generate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ topic })
    });

    const data = await res.json();

    if (Array.isArray(data)) {
      data.forEach((item, i) => {
        const card = document.createElement('div');
        card.className = 'title-card';
        card.textContent = item.generated_text || item.text || "No title";
        card.style.animationDelay = `${i*0.1}s`;
        titlesContainer.appendChild(card);
      });
    } else {
      const card = document.createElement('div');
      card.className = 'title-card';
      card.textContent = "Error generating titles";
      titlesContainer.appendChild(card);
    }
  } catch (err) {
    console.error(err);
    const card = document.createElement('div');
    card.className = 'title-card';
    card.textContent = "Error generating titles";
    titlesContainer.appendChild(card);
  }
}

generateBtn.addEventListener('click', async () => {
  const topic = topicInput.value.trim();
  if (!topic) return;
  generateBtn.disabled = true;
  await generateTitles(topic);
  generateBtn.disabled = false;
});
</script>

